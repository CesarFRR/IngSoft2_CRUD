-- MySQL Script generated by MySQL Workbench
-- Thu Aug 31 21:50:30 2023
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------


-- -----------------------------------------------------
-- Schema lab_crud
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `lab_crud` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci ;
USE `lab_crud` ;
-- -----------------------------------------------------
-- Table `lab_crud`.`municipios`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `lab_crud`.`municipios` (
  `id` INT NOT NULL,
  `nombre` VARCHAR(100) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `lab_crud`.`viviendas`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `lab_crud`.`viviendas` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `direccion` VARCHAR(50) NOT NULL,
  `id_municipio` INT NOT NULL,
  `capacidad` INT NOT NULL,
  `niveles` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `municipios` (`id_municipio` ASC) VISIBLE,
  CONSTRAINT `viviendas_ibfk_1`
    FOREIGN KEY (`id_municipio`)
    REFERENCES `lab_crud`.`municipios` (`id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `lab_crud`.`personas`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `lab_crud`.`personas` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `tipo_doc` TEXT NOT NULL,
  `nombre` TEXT NOT NULL,
  `fecha_nac` DATE NOT NULL,
  `sexo` VARCHAR(10) NOT NULL,
  `telefono` VARCHAR(20) NULL DEFAULT NULL,
  `id_vivienda_actual` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `vivienda_actual` (`id_vivienda_actual` ASC) VISIBLE,
  CONSTRAINT `personas_ibfk_1`
    FOREIGN KEY (`id_vivienda_actual`)
    REFERENCES `lab_crud`.`viviendas` (`id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `lab_crud`.`cdf`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `lab_crud`.`cdf` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `id_persona` INT NOT NULL,
  `id_cdf` INT NOT NULL,
  `fecha_registro` DATE NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `id_persona` (`id_persona` ASC) VISIBLE,
  INDEX `id_cdf` (`id_cdf` ASC) VISIBLE,
  CONSTRAINT `cdf_ibfk_1`
    FOREIGN KEY (`id_persona`)
    REFERENCES `lab_crud`.`personas` (`id`),
  CONSTRAINT `cdf_ibfk_2`
    FOREIGN KEY (`id_cdf`)
    REFERENCES `lab_crud`.`personas` (`id`))
ENGINE = InnoDB
AUTO_INCREMENT = 3
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `lab_crud`.`posesiones`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `lab_crud`.`posesiones` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `id_persona` INT NOT NULL,
  `id_vivienda` INT NOT NULL,
  `fecha_posesion` DATE NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `id_persona` (`id_persona` ASC) VISIBLE,
  INDEX `id_vivienda` (`id_vivienda` ASC) VISIBLE,
  CONSTRAINT `posesiones_ibfk_1`
    FOREIGN KEY (`id_persona`)
    REFERENCES `lab_crud`.`personas` (`id`),
  CONSTRAINT `posesiones_ibfk_2`
    FOREIGN KEY (`id_vivienda`)
    REFERENCES `lab_crud`.`viviendas` (`id`))
ENGINE = InnoDB
AUTO_INCREMENT = 4
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- ------------------------------------------------------- ------------------------------------------------------- ---------------------------------

INSERT INTO MUNICIPIOS (id, nombre)
VALUES
    (1, 'Bogotá'),
    (2, 'Soacha'),
    (3, 'Chía'),
    (4, 'Cajicá'),
    (101, 'Girardot'),
    (102, 'Zipaquirá');

INSERT INTO VIVIENDAS (id, direccion, id_municipio, capacidad, niveles)
VALUES
    (1, 'Calle 123', 1, 4, 2),
    (2, 'Avenida Principal', 2, 6, 3),
    (3, 'Carrera 456', 1, 2, 1);

-- Insertar filas en la tabla PERSONAS
INSERT INTO PERSONAS (id, tipo_doc, nombre, fecha_nac, sexo, telefono, id_vivienda_actual)
VALUES
    (1, 'DNI', 'Juan Pérez', '1990-05-15', 'Masculino', 123456789, 1),
    (2, 'Cédula', 'María García', '1985-10-20', 'Femenino', NULL, 2),
    (3, 'Pasaporte', 'Alex Smith', '2000-03-02', 'Otro', 987654321, 2);

-- Insertar filas en la tabla CDF
INSERT INTO CDF (id_persona, id_cdf, fecha_registro)
VALUES
    (2, 1, '2023-08-01'),
    (3, 1, '2023-08-02');

-- Insertar filas en la tabla posesiones
INSERT INTO posesiones (id_persona, id_vivienda, fecha_posesion)
VALUES
    (1, 1, '2023-08-01'),
    (2, 2, '2023-08-02'),
    (3, 3, '2023-08-03');
